Индексы:
1) Без индекса будет тяжело выполняться фильтрация по дате WHERE o.created_at >= NOW() - INTERVAL '1 month', так что при больших нагрузках я бы накинул индекс на поле created_at
2) Также в джоине JOIN orders o ON o.id = oi.order_id мне нужен быстрый доступ к полю oi.order_id, так что я бы добавил индекс и на это поле
3) GROUP BY oi.product_id для группировки так же было бы хорошо, если бы был индекс на product_id. В теории можно добавить составной индекс на product_id и order_id из предыдущего пункта под конкретно запрос 2.3.1
4) Также добавил бы индекс на fk: products.category_id и categoies.parent_id, для ускорения тяжелых джоинов

Оптимизация SQL:
1) Щас мы делаем self join по всем категориям, а потом одбираем те, которые продавались в последний месяц. Если существует много не популярных категорий товаров, то я бы переписал эту часть, так чтобы мы проходили, только по заранее полученным категориям. Например, можно добавить для каждой категории товаров поле с id ее корневой категории. Это также избавит он необходимости рекурсии.
2) Пока неизвестно кол-во подкатегорий я бы оставил рекурсивный cte. Если в будущем от бизнеса будут изменения по архитектуре категорий (добавиться лимит), то переписал бы без рекурсии
3) Самый эффективный вариант - создание таблицы с проданными товарами и их кол-вом и парой индексов для группировки для аналитики. Из минусов - необходимость добавления заказов в эту таблицу также, но тк данные эти не будут нужны в ту же секунду актуальные, то можно выносить эту задачу синхронизации таблицы приложения и таблицы аналитики в отдельный процесс, чтобы не тормозить основной поток